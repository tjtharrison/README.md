<head>
    <title>Tim Harrison</title>

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css"
        integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v6.1.0/css/all.css">
    <link href="https://fonts.googleapis.com/css?family=Open+Sans" rel="stylesheet">
    <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Source+Code+Pro&display=swap" rel="stylesheet">
    <link rel='stylesheet' href='/static/styles.css' />
    <link rel='stylesheet' href='/static/mobile.css' />
</head>

<div id="header_block">
    <p class="deploy_message">This site has been generated and deployed from Github repository <a
            href="https://github.com/tjtharrison/README.md" target="_blank">tjtharrison/README.md</a></p>
    <div id="header_wrapper">


        <p><img class="me" src="/img/timh.png" /></p>

        <h2>Tim Harrison</h2>
        <h3>Infrastructure Team Lead</h3>

        <ul class="navigation">
            <li><a href="/">Home</a></li>
            <li><a href="/pages/runbooks/">Runbooks</a></li>
            <li><a href="/pages/guides">Guides</a></li>
            <li><a target="_blank"
                    href="https://www.credly.com/users/tim-harrison.41ce8b8d/badges">Credly <i
                        class="fa-solid fa-arrow-up-right-from-square"></i></a></li>
            <li><a target="_blank" href="https://github.com/tjtharrison">Github <i
                        class="fa-solid fa-arrow-up-right-from-square"></i></a></li>
            <li><a target="_blank" href="https://www.linkedin.com/in/tim-harrison-47b11159/"> LinkedIn <i
                        class="fa-solid fa-arrow-up-right-from-square"></i></a></li>
        </ul>


    </div>
</div>

<div id="body">
    </div></div><h1>Setting up a Check_MK user with limited host access</h1>
<p>This guide should be used to setup a user on check_mk with access only to a subset of hosts monitored within Check_mk.</p>
<p>In this example, we will be creating a user that should ONLY have access to servers hosted on digital ocean).</p>
<h2>Reviewing Role Access:</h2>
<p>First thing to do will be to review the roles in check_mk to confirm the role that you will be assigning to the new user has “See all host and services“ set to “no”. NOTE: The role will determine the access that the user has within check_mk (Eg permissions to perform actions on hosts) so this should be configured as per your requirement..</p>
<h2>Creating Contact Group:</h2>
<p>Browse to “Contact Groups“ on the left hand side of Check_MK and click “New contact group“ at the top of the page.</p>
<p>Add a name and alias as required, eg</p>
<blockquote>
<p>Name: digitalOcean ## The internal name used by check_mk
Alias: Digital Ocean ## The nice name visible within the UI.</p>
</blockquote>
<p>Create the group and apply the config changes.</p>
<h2>Creating Contact Group Rules:</h2>
<p>The next stage is to create a rule which will automatically add the required hosts to the Contact Group that will be used by our new user.Setting up a Check_MK user with limited host access</p>
<p><em>NOTE: The below instructions should be adjusted depending on the setup, eg if you wish to only add servers with a tag of “database” – Use this in the CG Rule instead.</em></p>
<p>On the Contact Group page in Check_MK, click the “Rules“ button at the top of the page</p>
<p>On the following page, click on “Assignment of hosts to contact groups” and Create rule in folder at the bottom of the page.</p>
<p>Add a description for the rule (Eg Digital Ocean Servers) and apply conditions as appropriate for your check. In our example we will add all hosts from the “Folder“ DO (Digital Ocean):</p>
<h2>Applying CG to User:</h2>
<p>Go to the users page from the link on the left hand panel and edit / create your user that you wish to apply these changes to.</p>
<p>Under the Contact Groups section, tick the box to add them to the newly created Contact group, ensure they are a member of the Role that you checked earlier and job done!</p>
</div>
