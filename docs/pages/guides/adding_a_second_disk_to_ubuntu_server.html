<head>
    <title>Tim Harrison</title>

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css"
        integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v6.1.0/css/all.css">
    <link href="https://fonts.googleapis.com/css?family=Open+Sans" rel="stylesheet">
    <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Source+Code+Pro&display=swap" rel="stylesheet">
    <link rel='stylesheet' href='/static/styles.css' />
    <link rel='stylesheet' href='/static/mobile.css' />
</head>

<div id="header_block">
    <p class="deploy_message">This site has been generated and deployed from Github repository <a
            href="https://github.com/tjtharrison/README.md" target="_blank">tjtharrison/README.md</a></p>
    <div id="header_wrapper">


        <p><img class="me" src="/img/timh.png" /></p>

        <h2>Tim Harrison</h2>
        <h3>DevSecOps Team Lead</h3>

        <ul class="navigation">
            <li><a href="/">Home</a></li>
            <li><a href="/pages/runbooks/">Runbooks</a></li>
            <li><a href="/pages/guides">Guides</a></li>
            <li><a target="_blank"
                    href="https://www.credly.com/users/tim-harrison.41ce8b8d/badges">Credly <i
                        class="fa-solid fa-arrow-up-right-from-square"></i></a></li>
            <li><a target="_blank" href="https://github.com/tjtharrison">Github <i
                        class="fa-solid fa-arrow-up-right-from-square"></i></a></li>
            <li><a target="_blank" href="https://www.linkedin.com/in/tim-harrison-47b11159/"> LinkedIn <i
                        class="fa-solid fa-arrow-up-right-from-square"></i></a></li>
        </ul>


    </div>
</div>

<div id="body">
    </div></div><h1>Adding a second disk to Ubuntu Server</h1>
<p>Add disk to your virtual machine to the size you require, choosing either thin or thick provisioning as appropriate. I typically do this while the machine is powered down so that it can be picked up when Ubuntu boots</p>
<p>Make yourself a mount point for your second drive. This can be wherever you chose, though I tend to create these points within the /media/ directory.</p>
<pre class="highlight"><pre>mkdir /media/[seconddiskname]</pre></pre>
<p>Make the disk and all subfolders accessible by all users (if required)</p>
<pre class="highlight"><pre>chmod -R 777 /media/[seconddiskname]</pre></pre>
<p>Typically your second disk will be sdb (/dev/sdb), though you can confirm this by running the below command to see all physical disks on the server:</p>
<pre class="highlight"><pre>fdisk -l</pre></pre>
<p>We will proceed with the below on the assumption that your second disk is sdb (Though adjust as required).
<pre class="highlight"><pre>fdisk /dev/sdb</pre></pre></p>
<p>Create a new primary partition with all other default settings by following the below:</p>
<pre class="highlight"><pre>n &gt; p &gt; 1 &gt; [enter] &gt; [enter] &gt; w</pre></pre>
<p>We now need to create a filesystem on the partition on the new disk in order to mount this to your virtual machine:</p>
<pre class="highlight"><pre>mkfs -t ext4 /dev/sdb1</pre></pre>
<p>We now need to set this partition to mount to your machine each time it starts, this is done by editing the fstab file.</p>
<pre class="highlight"><pre>nano /etc/fstab</pre></pre>
<p>Add a line to the bottom of the file similar to the below, though replacing relevant sections with your partitions / mount points as above.</p>
<pre class="highlight"><pre>/dev/sdb1 /media/[seconddiskname] ext4 defaults 0 0</pre></pre>
<p>Run the command below to ‘Mount all’ devices to the system (including your new parition). If this completes with no errors you are good to go. You can confirm this by running the command below and ensuring your mount point is listed:</p>
<pre class="highlight"><pre>mount -a
df -h</pre></pre>
<p>The result should be similar to the below, with your new drive at the bottom.:</p>
<pre class="highlight"><pre>Filesystem Size Used Avail Use% Mounted on
/dev/mapper/server--vg-root 15G 3.2G 11G 23% /
none 4.0K 0 4.0K 0% /sys/fs/cgroup
udev 1.5G 8.0K 1.5G 1% /dev
tmpfs 301M 552K 301M 1% /run
none 5.0M 0 5.0M 0% /run/lock
none 1.5G 0 1.5G 0% /run/shm
none 100M 0 100M 0% /run/user
/dev/sda1 236M 95M 129M 43% /boot
/dev/sdb1 50G 420M 47G 1% /media/seconddisk</pre></pre>
</div>
