<head>
    <title>Tim Harrison</title>

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css"
        integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v6.1.0/css/all.css">
    <link href="https://fonts.googleapis.com/css?family=Open+Sans" rel="stylesheet">
    <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Source+Code+Pro&display=swap" rel="stylesheet">
    <link rel='stylesheet' href='/static/styles.css' />
    <link rel='stylesheet' href='/static/mobile.css' />
</head>

<div id="header_block">
    <p class="deploy_message">This site has been generated and deployed from Github repository <a
            href="https://github.com/tjtharrison/README.md" target="_blank">tjtharrison/README.md</a></p>
    <div id="header_wrapper">


        <p><img class="me" src="/img/timh.png" /></p>

        <h2>Tim Harrison</h2>
        <h3>Infrastructure Team Lead</h3>

        <ul class="navigation">
            <li><a href="/">Home</a></li>
            <li><a href="/pages/runbooks/">Runbooks</a></li>
            <li><a href="/pages/guides">Guides</a></li>
            <li><a target="_blank"
                    href="https://www.credly.com/users/tim-harrison.41ce8b8d/badges">Credly <i
                        class="fa-solid fa-arrow-up-right-from-square"></i></a></li>
            <li><a target="_blank" href="https://github.com/tjtharrison">Github <i
                        class="fa-solid fa-arrow-up-right-from-square"></i></a></li>
            <li><a target="_blank" href="https://www.linkedin.com/in/tim-harrison-47b11159/"> LinkedIn <i
                        class="fa-solid fa-arrow-up-right-from-square"></i></a></li>
        </ul>


    </div>
</div>

<div id="body">
    </div></div><h1>Adding Additional Kube config file to local Kubernetes contexts</h1>
<p>How to add additional Kubernetes configurations to your local Kube config to access additional clusters.
Getting a list of current contexts:</p>
<pre class="highlight"><pre>tim@tjth-laptop:~/.kube$ kubectl config get-contexts
CURRENT NAME CLUSTER AUTHINFO NAMESPACE
* dev dev dev-admin 
 home kubernetes kubernetes-admin</pre></pre>
<p>Connect to your new Kubernetes Cluster Master via SSH and edit the ~/.kube/config file created during kubeadm init.</p>
<p>Update the following fields (To an appropriate name for the new cluster):</p>
<pre class="highlight"><pre>clusters:
 cluster:
  name: [update-this]
contexts:
 context:
  cluster: [same as cluster name]
  user: [clustername-admin]
 name: [same as cluster name]
users:
 -name: [same as user name above]</pre></pre>
<p>Now, copy this file to your local machine (Eg to ~/.kube/config-[env-name])</p>
<p>Now (After backing up the current config file) you must use kubeconfig to combine your existing kube config file with the new one, to create a new file “config-new” which you then replace the live config file with.</p>
<pre class="highlight"><pre>cd ~/.kube
cp config config-bak-$(date +%F)
KUBECONFIG=~/.kube/config:~/.kube/config-dev kubectl config view --merge --flatten &gt; ~/.kube/config-all
rm -rf config
mv config-all config</pre></pre>
<p>If you run the get-contexts command again, you should now see your new Kubernetes cluster listed.</p>
</div>
